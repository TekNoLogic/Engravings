
local myname, ns = ...
local _, class = UnitClass("player")


ns.spec_weights = {}

if class == 'DRUID' then
	ns.spec_weights.Balance = {
		ITEM_MOD_INTELLECT_SHORT = 100,
		ITEM_MOD_HIT_RATING_SHORT = 90,
		ITEM_MOD_SPELL_POWER_SHORT = 83,
		ITEM_MOD_CRIT_RATING_SHORT = 52,
		ITEM_MOD_HASTE_RATING_SHORT = 50,
		ITEM_MOD_MASTERY_RATING_SHORT = 45,
	}
	ns.spec_weights.Feral = {
		ITEM_MOD_AGILITY_SHORT = 100,
		ITEM_MOD_DAMAGE_PER_SECOND_SHORT = 96,
		ITEM_MOD_STRENGTH_SHORT = 41,
		ITEM_MOD_MASTERY_RATING_SHORT = 41,
		ITEM_MOD_ATTACK_POWER_RATING_SHORT = 39,
		ITEM_MOD_HIT_RATING_SHORT = 32,
		ITEM_MOD_EXPERTISE_RATING_SHORT = 32,
		ITEM_MOD_CRIT_RATING_SHORT = 31,
		ITEM_MOD_HASTE_RATING_SHORT = 29,
  }
	ns.spec_weights.Guardian = {
		ITEM_MOD_AGILITY_SHORT = 100,
		ITEM_MOD_DODGE_RATING_SHORT = 82,
		ITEM_MOD_MASTERY_RATING_SHORT = 44,
		ITEM_MOD_CRIT_RATING_SHORT = 41,
		ITEM_MOD_HASTE_RATING_SHORT = 24,
		ITEM_MOD_HIT_RATING_SHORT = 21,
		ITEM_MOD_EXPERTISE_RATING_SHORT = 21,
		RESISTANCE0_NAME = 18, --Armor
		ITEM_MOD_STAMINA_SHORT = 18,
		ITEM_MOD_ATTACK_POWER_RATING_SHORT = 3,
		ITEM_MOD_STRENGTH_SHORT = 3,
  }
	ns.spec_weights.Restoration = {
		ITEM_MOD_INTELLECT_SHORT = 100,
		ITEM_MOD_SPELL_POWER_SHORT = 85,
		ITEM_MOD_HASTE_RATING_SHORT = 80,
		ITEM_MOD_SPIRIT_SHORT = 75,
		ITEM_MOD_MASTERY_RATING_SHORT = 65,
		ITEM_MOD_CRIT_RATING_SHORT = 60,
  }
end


if class == 'PALADIN' then
	ns.spec_weights.Holy = {
		ITEM_MOD_INTELLECT_SHORT = 100,
		ITEM_MOD_SPIRIT_SHORT = 75,
		ITEM_MOD_SPELL_POWER_SHORT = 75,
		ITEM_MOD_HASTE_RATING_SHORT = 55,
		ITEM_MOD_MASTERY_RATING_SHORT = 50,
		ITEM_MOD_CRIT_RATING_SHORT = 50,
	}
	ns.spec_weights.Protection = {
		ITEM_MOD_MASTERY_RATING_SHORT = 100,
		ITEM_MOD_HIT_RATING_SHORT = 63,
		RESISTANCE0_NAME = 62, --Armor
		ITEM_MOD_EXPERTISE_RATING_SHORT = 41,
		ITEM_MOD_HASTE_RATING_SHORT = 39,
		ITEM_MOD_STRENGTH_SHORT = 38,
		ITEM_MOD_DODGE_RATING_SHORT = 34,
		ITEM_MOD_PARRY_RATING_SHORT = 34,
		ITEM_MOD_STAMINA_SHORT = 29,
  }
	ns.spec_weights.Retribution = {
		-- ITEM_MOD_INTELLECT_SHORT = 100, -- Speed
		ITEM_MOD_DAMAGE_PER_SECOND_SHORT = 98,
		ITEM_MOD_STRENGTH_SHORT = 58,
		ITEM_MOD_EXPERTISE_RATING_SHORT = 41,
		ITEM_MOD_HIT_RATING_SHORT = 41,
		ITEM_MOD_MASTERY_RATING_SHORT = 26,
		ITEM_MOD_ATTACK_POWER_RATING_SHORT = 24,
		ITEM_MOD_CRIT_RATING_SHORT = 24,
  }
end


if class == 'PRIEST' then
	ns.spec_weights.Discipline = {
		ITEM_MOD_INTELLECT_SHORT = 100,
		ITEM_MOD_SPIRIT_SHORT = 80,
		ITEM_MOD_SPELL_POWER_SHORT = 75,
		ITEM_MOD_MASTERY_RATING_SHORT = 60,
		ITEM_MOD_HASTE_RATING_SHORT = 50,
		ITEM_MOD_CRIT_RATING_SHORT = 40,
	}
	ns.spec_weights.Holy = {
		ITEM_MOD_INTELLECT_SHORT = 100,
		ITEM_MOD_SPIRIT_SHORT = 80,
		ITEM_MOD_SPELL_POWER_SHORT = 75,
		ITEM_MOD_HASTE_RATING_SHORT = 75,
		ITEM_MOD_MASTERY_RATING_SHORT = 70,
		ITEM_MOD_CRIT_RATING_SHORT = 50,
  }
	ns.spec_weights.Shadow = {
		ITEM_MOD_INTELLECT_SHORT = 100,
		ITEM_MOD_SPIRIT_SHORT = 77,
		ITEM_MOD_SPELL_POWER_SHORT = 56,
		ITEM_MOD_HASTE_RATING_SHORT = 54,
		ITEM_MOD_HIT_RATING_SHORT = 54,
		ITEM_MOD_MASTERY_RATING_SHORT = 52,
		ITEM_MOD_CRIT_RATING_SHORT = 47,
  }
end


local gem_stats = {
	-- Red
	ITEM_MOD_INTELLECT_SHORT = 40,
	ITEM_MOD_PARRY_SHORT = 40,
	ITEM_MOD_AGILITY_SHORT = 40,
	ITEM_MOD_STRENGTH_SHORT = 40,

	-- Yellow
	ITEM_MOD_MASTERY_RATING_SHORT = 40,
	-- ITEM_MOD_PVP_RESILIANCE_RATING_SHORT = 40,
	ITEM_MOD_HASTE_RATING_SHORT = 40,
	ITEM_MOD_DODGE_RATING_SHORT = 40,
	ITEM_MOD_CRIT_RATING_SHORT = 40,

	-- Blue
	-- ITEM_MOD_PVP_POWER_SHORT = 40,
	ITEM_MOD_STAMINA_SHORT = 60,
	ITEM_MOD_HIT_RATING_SHORT = 40,
	ITEM_MOD_SPIRIT_SHORT = 40,
}

for spec,weights in pairs(ns.spec_weights) do
	local bestval, best = 0

	for stat,val in pairs(weights) do
		local weighted_val = val * (gem_stats[stat] or 0)
		if weighted_val > bestval then bestval, best = weighted_val, stat end
	end

	ns.gem_value = bestval
end
